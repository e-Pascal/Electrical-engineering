# Часть 4. Схема формирования питания для МК, ПЛИС и ОУ

## Содержание

1. [Введение](#введение)
2. [Теоретическая база](#теоретическая-база)
   - [Особенности питания микроконтроллеров](#особенности-питания-микроконтроллеров)
   - [Особенности питания ПЛИС](#особенности-питания-плис)
   - [Особенности питания операционных усилителей](#особенности-питания-операционных-усилителей)
   - [Согласование различных уровней напряжений](#согласование-различных-уровней-напряжений)
3. [Практические примеры](#практические-примеры)
   - [Схема питания для STM32 и Artix-7](#схема-питания-для-stm32-и-artix-7)
   - [Схема питания для ОУ LM358](#схема-питания-для-оу-lm358)
4. [Выбор компонентов и расчёты](#выбор-компонентов-и-расчёты)
5. [Инженеру на заметку](#инженеру-на-заметку)
6. [Заключение](#заключение)

---

## Введение

В четвёртой части курсовой работы рассматривается разработка схемы питания на основе вторичных источников питания (ВИП) для микроконтроллера (МК), программируемой логической интегральной схемы (ПЛИС) и операционного усилителя (ОУ). Особое внимание в данной части уделено выбору стабилизаторов, расчётам их параметров и особенностям фильтрации.

---

## Теоретическая база. ПИТАНИЕ

### Питание микроконтроллеров

Питание МК — это важнейший аспект проектирования схем, от которого зависит стабильность работы как самого устройства, так и всей системы. Современные микроконтроллеры требуют формирования разного уровня напряжений для питания ядра, периферийных модулей и аналоговых цепей.

---

#### Особенности 

Система питания МК как правило включает в себя следующие выводы:
- VDD: внешнее питание для части блока ввода-вывода, внутреннего регулятора и аналоговых систем, таких как сброс, управление питанием и внутреннее тактирование;
- VDDA: внешнее аналоговое питание для АЦП, ЦАП, операционных усилителей, компараторов и источника опорного напряжения. Питание VDDA независимо от VDD;
- VREF: используется для установки точного уровня опорного напряжения. 
- VBAT: питает часы реального времени RTC, внешний генератор 32 кГц и регистры восстановления, когда отсутствует основное питание.

<p align="center" > <img src="./pic/p1.png"></p>

<p align="center" >Рисунок 3.1 – ...</p>

Рассмотрим пример МК от разных производителей, такие как STM32, ESP32 или PIC, которые имеют следующие особенности:

- **Ядро процессора**:
  Работает на низком напряжении ($V_\\text{CORE}$) от $1,1 \\ \\text{В}$ до $1,8 \\ \\text{В}$, что снижает энергопотребление и увеличивает производительность.
  
- **Периферийные интерфейсы**:
  GPIO, UART, SPI и другие интерфейсы питаются от напряжения ($V_\\text{IO}$), обычно $3,3 \\ \\text{В}$ или $5 \\ \\text{В}$.

- **Аналоговые модули**:
  АЦП и ЦАП требуют стабильного опорного напряжения ($V_\\text{REF}$), чтобы обеспечить точные измерения.

- **Резервный домен**:
  RTC и энергонезависимая память питаются от ($V_\\text{BAT}$), часто это $1,8 \\ \\text{В}$ или литиевая батарея на $3,0 \\ \\text{В}$.

---

#### Практические примеры

##### STM32H7
- $V_\\text{CORE} = 1,2 \\ \\text{В}$, $I_\\text{CORE} = 0,5 \\ \\text{А}$.
- $V_\\text{IO} = 3,3 \\ \\text{В}$, $I_\\text{IO} = 0,3 \\ \\text{А}$.
- $V_\\text{REF} = 3,3 \\ \\text{В}$ для аналоговых модулей.

##### ESP32
- Основное питание: $3,3 \\ \\text{В}$, ток до $0,5 \\ \\text{А}$.
- Уровни интерфейсов согласуются через преобразователи напряжений для периферии на $5.0 \\ \\text{В}$.

##### PIC18F45K22
- Одинаковый уровень напряжения питания $5,0 \\ \\text{В}$ для ядра и периферии.
- Минимальное потребление $20 \\ \\text{мА}$ в режиме сна.

---

#### Пример выбора микросхем ВИП и расчёты

##### Исходные данные:
- $V_\\text{CORE} = 1,2 \\ \\text{В}, I_\\text{CORE} = 0,5 \\ \\text{А}$.
- $V_\\text{IO} = 3,3 \\ \\text{В}, I_\\text{IO} = 0,3 \\ \\text{А}$.
- $V_\\text{IN} = 5,0 \\ \\text{В}$.

---

##### Выбор микросхем

###### Для $V_\\text{CORE}$:
- Импульсный стабилизатор **Texas Instruments TPS62097**:
  - Выходное напряжение: $1,2 \\ \\text{В}$.
  - Максимальный выходной ток: $1,0 \\ \\text{А}$.
  - КПД: $\\approx 90\\%$ при указанных параметрах.

###### Для $V_\\text{IO}$:
- Линейный стабилизатор **Analog Devices LT1963**:
  - Выходное напряжение: $3,3 \\ \\text{В}$.
  - Низкий уровень шумов: $<40 \\ \\mu\\text{В}$.

---

##### Расчёты

###### Для $V_\\text{CORE}$ с импульсным стабилизатором:
1. Выходная мощность:
   $$P_\\text{OUT} = V_\\text{OUT} \\cdot I_\\text{OUT} = 1,2 \\cdot 0,5 = 0,6 \\ \\text{Вт}.$$
2. Входная мощность:
   $$P_\\text{IN} = \\frac{P_\\text{OUT}}{\\eta} = \\frac{0,6}{0,9} = 0,667 \\ \\text{Вт}.$$
3. Входной ток:
   $$I_\\text{IN} = \\frac{P_\\text{IN}}{V_\\text{IN}} = \\frac{0.667}{5,0} = 0.133 \\ \\text{А}.$$

###### Для $V_\\text{IO}$ с линейным стабилизатором:
1. Тепловыделение:
   $$P_\\text{DISS} = (V_\\text{IN} - V_\\text{OUT}) \\cdot I_\\text{OUT} = (5,0 - 3,3) \\cdot 0,3 = 0,51 \\ \\text{Вт}.$$
2. Выходная мощность:
   $$P_\\text{OUT} = V_\\text{OUT} \\cdot I_\\text{OUT} = 3,3 \\cdot 0,3 = 0,99 \\ \\text{Вт}.$$

---

##### Итоговые параметры системы
- Общая входная мощность:
  $$P_\\text{IN (общ)} = P_\\text{IN (CORE)} + P_\\text{DISS (IO)} + P_\\text{OUT (IO)} = 0,667 + 0,51 + 0,99 = 2.167 \\ \\text{Вт}.$$

---


### Питание ПЛИС

Программируемые логические интегральные схемы (ПЛИС) обладают высокой производительностью и требуют сложной системы питания. Основные особенности включают множество уровней напряжений, высокое энергопотребление, а также строгие требования к фильтрации помех. 

ПЛИС, как правило, имеют довольно сложные требования к питанию, включая несколько линий питания (часто при разных напряжениях), жесткие допуски напряжения, последовательность включения питания и плавный запуск. 

Требования к системе питания ПЛИС: 
1. Ограничить параметры переходного процесса при включении питания.
2. Максимально снизить уровень высокочастотного шума, неизбежного в цифровых высокоскоростных схемах. Для этого необходимы:
    - раздельные шины питания для различных основных потребителей тока;
    - установка достаточного количества фильтрующих конденсаторов.

Если эти требования не выполняются, то работа может быть ненадежной или ПЛИС может быть повреждена.

Структурная схема системы питания ПЛИС состоит из первичного источника питания, формирующего входное напряжение (Vin) для стабилизатора напряжения, схемы, устанавливающей последовательность подачи различных напряжений и по необходимости схемы слежения за уровнями напряжений (супервизор). Одним из ключевых компонентов системы питания является цепочка фильтрующих конденсаторов вокруг ПЛИС. Они позволяют распределить рабочий ток между потребителями, используя низкоимпедансные пути прохождения тока, тем самым снижая уровень высокочастотного шума. 

Все ПЛИС нуждаются в источнике напряжения питания ядра, но большинство сложных ПЛИС испытывают потребность и в отдельном источнике напряжения питания для блоков ввода-вывода, источнике опорных напряжений, источнике напряжения для дополнительных функций. Зачастую, для корректного формирования последовательсти подачи питания на ПЛИС используют супервизоры питания(не обязательный атрибут, но значительно повышающий качество формирования уровней). В некоторых ПЛИС важна последовательность подачи питания, для чего можно использовать супервизоры или включать стабилизаторы напряжения с задержкой(задержку подачи логического уровня можно формировать обычным RC фильтром). 
  
<p align="center" > <img src="./pic/p2.png"></p>

<p align="center" >Рисунок 3.1 – ...</p>

Для питания разных функциональных блоков ПЛИС используются различные уровни напряжения. Для обеспечения одного уровня напряжения необходим один вторичный источник питания. 

Рассмотрим более подробно основные типы напряжения питания, необходимые для ПЛИС:
- VCCINT. Внешнее напряжение питания ядра. Является основным питающим напряжением ПЛИС и, как правило, обеспечивает большую часть мощности, затрачиваемой в ПЛИС. Основное напряжение источника зависит от семейства ПЛИС. Напряжение питания ядра может использоваться и для питания конфигурационного перепрограммируемого постоянного запоминающего устройства. Для современных ПЛИС это напряжение обычно находится в диапазоне от 0,9 В до 1,2 В с допуском 5%.
- VCCO. Напряжение питания блоков ввода-вывода. Уровни напряжения определяются внешними цифровыми схемами и, поскольку многие современные ПЛИС имеют несколько портов ввода-вывода, каждый из них может питаться от своего источника для обеспечения интерфейса с различными типами цифровой логики. 
- VCCAUX. Вспомогательное напряжение питания, необходимое для различных вспомогательных функций ПЛИС, например для устройства управления тактовой частотой или интерфейсом JTAG. Вспомогательные устройства более чувствительны к шуму, нежели другие, и поэтому VCCAUX имеет более высокие требования по развязке для минимизации наведенного шума. В случае если источник питания ядра напряжением VCCO обладает низким шумом, от него можно запитать блоки вспомогательных функций
 
<p align="center" > <img src="./pic/p3.png"></p>

<p align="center" >Рисунок 4. – ...</p>



---

#### 1. Особенности питания ПЛИС

Современные ПЛИС, такие как **Xilinx Artix-7** или **Intel Cyclone V**, требуют раздельного питания для различных блоков. Основные уровни питания данной микросхемы включают:

1. **Питание ядра ($V_\\text{CORE}$)**:
   - Обеспечивает работу основной логики ядра.
   - Типичное напряжение: $0,9 \\, \\text{В} - 1,2 \\, \\text{В}$.
   - Ток потребления может достигать нескольких ампер в зависимости от активности логики.

2. **Питание интерфейсов ($V_\\text{IO}$)**:
   - Для работы GPIO и интерфейсов ввода-вывода (I²C, SPI, UART).
   - Обычно $3,3 \\, \\text{В}$ или $2,5 \\, \\text{В}$, чтобы соответствовать внешним устройствам.

3. **Питание вспомогательных блоков ($V_\\text{AUX}$)**:
   - Используется для тактовых генераторов, конфигурационной памяти и дополнительных модулей.
   - Типичное напряжение: $1,8 \\, \\text{В}$.

4. **Опорное напряжение ($V_\\text{REF}$)**:
   - Для работы аналоговых блоков и прецизионных схем.
   - Требует минимального уровня шумов, типичное значение — $1,25 \\, \\text{В} - 2,5 \\, \\text{В}$.

---

#### 2. Практические примеры

##### Пример 1: Xilinx Artix-7
Для ПЛИС **Artix-7** используются следующие уровни напряжений:
1. $V_\\text{CORE} = 1,0 \\, \\text{В}$, потребляемый ток $2 \\, \\text{А}$ при высокой загрузке логики.
2. $V_\\text{IO} = 3,3 \\, \\text{В}$, потребляемый ток $0,5 \\, \\text{А}$.
3. $V_\\text{AUX} = 1,8 \\, \\text{В}$, потребляемый ток $0,1 \\, \\text{А}$.

##### Пример 2: Intel Cyclone V
1. $V_\\text{CORE} = 1.1 \\, \\text{В}$, ток $1.8 \\, \\text{А}$.
2. $V_\\text{IO} = 2.5 \\, \\text{В}$, ток $0.3 \\, \\text{А}$.
3. $V_\\text{REF} = 1.25 \\, \\text{В}$ для опорных сигналов АЦП и ЦАП.

---

#### 3. Пример выбора микросхем ВИП и расчёты

##### Исходные данные:
Для ПЛИС Artix-7:
- $V_\\text{CORE} = 1,0 \\, \\text{В}, I_\\text{CORE} = 2,0 \\, \\text{А}$.
- $V_\\text{IO} = 3,3 \\, \\text{В}, I_\\text{IO} = 0,5 \\, \\text{А}$.
- $V_\\text{AUX} = 1,8 \\, \\text{В}, I_\\text{AUX} = 0,1 \\, \\text{А}$.

##### Выбор микросхем:
1. **Для $V_\\text{CORE}$:**
   - Импульсный стабилизатор **Texas Instruments LM21215A**:
     - Выходное напряжение: $1,0 \\, \\text{В}$.
     - Максимальный ток: $15 \\, \\text{А}$.
     - КПД: $92\\%$ при нагрузке $2,0 \\, \\text{А}$.

2. **Для $V_\\text{IO}$:**
   - Линейный стабилизатор **Analog Devices LT1963**:
     - Выходное напряжение: $3,3 \\, \\text{В}$.
     - Максимальный ток: $1,5 \\, \\text{А}$.
     - Низкий уровень шумов.

3. **Для $V_\\text{AUX}$:**
   - Импульсный стабилизатор **Texas Instruments TPS62933**:
     - Выходное напряжение: $1,8 \\, \\text{В}$.
     - Максимальный ток: $3,0 \\, \\text{А}$.
     - КПД: $94\\%$.

##### Расчёты:
1. **Для $V_\\text{CORE}$:**
   - Выходная мощность:
     $$P_\\text{OUT} = V_\\text{OUT} \\cdot I_\\text{OUT} = 1,0 \\cdot 2,0 = 2,0 \\, \\text{Вт}.$$
   - Входная мощность:
     $$P_\\text{IN} = \\frac{P_\\text{OUT}}{\\eta} = \\frac{2,0}{0,92} \\approx 2,17 \\, \\text{Вт}.$$

2. **Для $V_\\text{IO}$:**
   - Тепловыделение:
     $$P_\\text{DISS} = (V_\\text{IN} - V_\\text{OUT}) \\cdot I_\\text{OUT} = (5,0 - 3,3) \\cdot 0,5 = 0,85 \\, \\text{Вт}.$$

---



### Особенности питания операционных усилителей

Операционные усилители (ОУ) являются важной частью многих аналоговых и смешанных схем. Правильная организация питания этих компонентов влияет на их стабильность, точность и уровень шумов. В отличие от цифровых устройств, ОУ чувствительны к колебаниям напряжения питания, что делает критически важным выбор стабилизаторов и фильтров.

---

#### Питание ОУ: основные аспекты

Большинство операционных усилителей требуют двухполярного питания, то есть наличие положительного ($V_+$) и отрицательного ($V_-$) напряжений относительно общего провода ($GND$). Это позволяет корректно обрабатывать как положительные, так и отрицательные входные сигналы, что необходимо для многих схем обработки сигналов. Типичные уровни питания для аналоговых ОУ составляют:
- $V_+ = +15 \\, \\text{В}$, $V_- = -15 \\, \\text{В}$ — для прецизионных аналоговых схем.
- $V_+ = +5 \\, \\text{В}$, $V_- = -5 \\, \\text{В}$ — для низковольтных приложений.

Например, ОУ, такие как **LM358**, могут работать в однополярных схемах ($V_+ = 5 \\, \\text{В}, V_- = 0 \\, \\text{В}$), но это ограничивает диапазон обрабатываемых сигналов.

---

#### Влияние питания на параметры ОУ

Параметры операционных усилителей зависят от стабильности и уровня напряжений питания. Например:
- **Напряжение смещения** ($V_\\text{offset}$): нестабильное питание может привести к дрейфу смещения, что особенно критично для схем измерений.
- **Уровень шумов** ($V_\\text{noise}$): высокочастотные помехи в линии питания усиливаются схемой, ухудшая сигнал.
- **Полоса пропускания** ($BW$): недостаточное питание может ограничить верхнюю границу частотного диапазона.

Для минимизации влияния питания на работу ОУ применяются фильтрующие элементы, такие как LC-фильтры и байпасные конденсаторы.

---

#### Практический пример: питание LM358

Операционный усилитель **LM358** часто используется в низковольтных и экономичных схемах. Его питание может быть организовано как двухполярным ($\\pm 15 \\, \\text{В}$), так и однополярным ($0 - 5 \\, \\text{В}$).

1. **Двухполярное питание**:
   - Стабилизаторы: используют линейные стабилизаторы **LM7815** ($+15 \\, \\text{В}$) и **LM7915** ($-15 \\, \\text{В}$).
   - Фильтрация: конденсаторы $0,1 \\, \\mu\\text{Ф}$ размещаются на входе и выходе стабилизаторов для подавления высокочастотных помех.

2. **Однополярное питание**:
   - Источник: линейный стабилизатор **LM7805** для $+5 \\, \\text{В}$.
   - Ограничения: максимальный выходной сигнал ограничен диапазоном $0 - 5 \\, \\text{В}$.

---

#### Согласование питания ОУ с другими компонентами

В многокомпонентных схемах операционные усилители часто взаимодействуют с МК или ПЛИС. При этом важно обеспечить изоляцию питания аналоговых и цифровых компонентов. Например:
- Для питания ОУ может использоваться отдельный стабилизатор с низким уровнем шумов, такой как **Analog Devices LT3042**.
- Аналоговые цепи требуют выделенной земли, которая соединяется с цифровой землёй в одной точке (рядом со стабилизатором).

---

#### Итоги по питанию

1. **Обеспечьте стабильность напряжений**:
   - Используйте качественные стабилизаторы, подходящие для нагрузки (линейные для минимальных шумов, импульсные для высоких токов).
   - Проверяйте стабильность напряжений для всех уровней питания.

2. **Разделяйте аналоговые и цифровые цепи**:
   - Используйте изолированные источники питания для чувствительных компонентов, таких как ОУ или аналоговые модули.
   - Соединяйте земли аналоговых и цифровых цепей в одной точке (через "мостик").

3. **Планируйте многоуровневое питание**:
   - Для МК: обеспечьте отдельное питание для ядра, периферии и аналоговых модулей.
   - Для ПЛИС: организуйте питание для ядра, интерфейсов, вспомогательных блоков и опорного напряжения.
   - Для ОУ: при необходимости используйте двухполярное питание.

4. **Уделите внимание фильтрации помех**:
   - Размещайте байпасные конденсаторы ($0,1 \\, \\mu\\text{Ф}$) максимально близко к выводам питания каждого компонента.
   - Используйте дополнительные ёмкости ($10 \\, \\mu\\text{Ф}$) для снижения низкочастотных шумов.

5. **Продумайте топологию печатной платы**:
   - Делайте линии питания короткими и широкими, особенно для цепей с высокими токами (например, ядро ПЛИС).
   - Уменьшайте индуктивность и сопротивление дорожек.

6. **Обеспечьте защиту цепей питания**:
   - Устанавливайте диоды Шоттки для защиты от обратного тока.
   - Используйте TVS-диоды для предотвращения повреждений при всплесках напряжения.

7. **Учитывайте взаимодействие компонентов**:
   - Питание МК, ПЛИС и ОУ должно быть согласовано по уровням напряжений.
   - Если возможны помехи, устанавливайте фильтры между источниками питания и потребителями.

---

## Теоретическая база. ТАКТИРОВАНИЕ

Система тактирования является основным функциональным блоком, синхронизирующим все процессы и определяющим скорость их выполнения.

### 1. Генераторы и резонаторы

#### 1.1. Генераторы

Генераторы — это устройства, которые создают периодические сигналы для синхронизации работы различных компонентов в микросхемах. Генераторы могут быть как внутренними, так и внешними.

- **Внутренние генераторы** — встроены в микроконтроллер или ПЛИС и не требуют внешних компонентов. Они обычно основаны на RC-генераторах. Эти генераторы могут быть не такими точными, так как их частота зависит от температуры и других факторов.
  
  **Преимущества:** простота, отсутствие внешних компонентов.  
  **Недостатки:** низкая точность, зависимость от температуры и внешних факторов.

- **Внешние генераторы** — обычно кварцевые или микромеханические. Они обеспечивают высокую стабильность и точность частоты, часто используемые в системах с высокими требованиями.

  **Преимущества:** высокая точность и стабильность, широкая настройка частоты.  
  **Недостатки:** требуют отдельного источника питания, занимают больше места на плате.

**Отличие от резонаторов:** Генераторы требуют питания для работы и могут обеспечивать активное генерирование частоты, в то время как резонаторы (например, кварцевые или керамические) не нуждаются в источнике питания и используют пассивные свойства материалов для создания стабильной частоты.

#### 1.2. Резонаторы

Резонаторы — это устройства, использующие физические свойства материалов (кварца или керамики) для создания стабильных частотных колебаний. Резонаторы сами не генерируют сигнал, а лишь стабилизируют частоту, поэтому они не требуют питания, в отличие от генераторов.

- **Кварцевые резонаторы** — используют пьезоэлектрические свойства кварцевых кристаллов для генерации высокоточных колебаний.

  **Преимущества:** высокая точность (тысячные доли процента), высокая стабильность.  
  **Недостатки:** хрупкость, требуют дополнительных компонентов (например, конденсаторов).

- **Керамические резонаторы** — используют керамические материалы для создания колебаний. Они менее точные, чем кварцевые, но более устойчивы к внешним воздействиям.

  **Преимущества:** прочность, некоторые модели имеют встроенные конденсаторы, упрощая подключение.  
  **Недостатки:** меньшая точность (десятые доли процента).

**Отличие от генераторов:** Резонаторы не требуют питания и обеспечивают более низкую точность и стабильность по сравнению с генераторами.

### 2. Тактирование микроконтроллеров

Микроконтроллеры могут быть тактированы с использованием различных источников частоты, в зависимости от требований к точности и стабильности.

- **Внутренний генератор (RC-генератор):** подходит для приложений с невысокими требованиями к точности.
  
  **Преимущества:** низкая стоимость, простота.  
  **Недостатки:** низкая точность, зависимость от температуры.

- **Внешний кварцевый резонатор:** предоставляет высокую точность и стабильность частоты.

  **Преимущества:** высокая точность, стабильность.  
  **Недостатки:** требуют дополнительных компонентов (конденсаторы), чувствительны к механическим повреждениям.

  <p align="center" > <img src="./pic/p4.png"></p>

  <p align="center" >Рисунок - Подключение внешнего резонатора </p>

- **Внешний генератор:** обеспечивает точность и стабильность частоты с высокой точностью.

  **Преимущества:** высокая точность и стабильность.  
  **Недостатки:** требуют отдельного источника питания, увеличивает размер системы.

  <p align="center" > <img src="./pic/p5.png"></p>

  <p align="center" >Рисунок - Подключение внешнего генератора </p>

- **RC-цепочка:** дешёвый и простой способ получения тактовой частоты, но с наименьшей точностью.

  **Преимущества:** низкая стоимость.  
  **Недостатки:** низкая точность частоты, погрешности до десятков процентов.

  <p align="center" > <img src="./pic/p6.png"></p>

  <p align="center" >Рисунок - Подключение RC-цепочки </p>

### 3. Тактирование ПЛИС

Для ПЛИС чаще всего используются внешние генераторы с высокой стабильностью частоты. Обычно это кварцевые или микромеханические генераторы.

- **Кварцевые или микромеханические генераторы:** обеспечивают точную и стабильную частоту.

  **Преимущества:** высокая точность и стабильность.  
  **Недостатки:** требуют отдельного источника питания и больше места на плате.

- **Буферные схемы для генераторов:** применяются для минимизации искажений сигнала и повышения надёжности работы ПЛИС.

  **Преимущества:** защита от искажений, повышение надёжности.  
  **Недостатки:** увеличение сложности схемы и стоимости.

 
## ИНТЕРФЕЙСЫ

### Общая информация об интерфейсах

Интерфейс — это совокупность механических, электрических и программных средств, с помощью которых компоненты системы взаимодействуют для обмена информацией.

Интерфейсы можно классифицировать по нескольким признакам, например:

#### 1. **По назначению:**
- **Интерфейсы программирования и отладки** — предназначены для записи прошивок, тестирования и отладки работы микросхем. Например, JTAG, SWD, SWIM.
- **Интерфейсы передачи данных** — используются для обмена данными между устройствами, такими как UART, SPI, I2C, CAN, USB, PCI и PCIe.

#### 2. **По синхронности:**
- **Синхронные интерфейсы** — обмен данными происходит с использованием тактового сигнала. Например, SPI, I2C, CAN.
- **Асинхронные интерфейсы** — данные передаются без использования тактового сигнала. Пример: UART, USB.

#### 3. **По параллельности:**
- **Последовательные интерфейсы** — данные передаются по одной линии последовательно. Например, UART, SPI, I2C, USB.
- **Параллельные интерфейсы** — данные передаются по нескольким линиям одновременно. Пример: PCI, PCIe.
###

---

Выводы МК и ПЛИС могут быть сконфигурированы программным путём в зависимости от назначения и используемого интерфейса. В случае ПЛИС три варианта: in (вход), out (выход), inout (двунаправленный порт). В случае с МК существуют больше вариантов.

## Режимы пользовательских выводов микроконтроллера

Каждый пользовательский вывод микроконтроллера (МК) может использоваться в одном из следующих режимов:

- **Input floating** — вход без подтягивающего резистора, брошенный в воздухе вход.
- **Input pull-up** — вход с подтягивающим резистором, подключенным к питанию.
- **Input pull-down** — вход с подтягивающим резистором, подключенным к общему проводу (земле).
- **Analog** — аналоговый вход (вход АЦП, компараторов и т.п.).
- **Output open-drain** — выход с открытым стоком. Функционально аналогичен выходу с открытым коллектором. При низком логическом уровне замыкает вывод на землю, при высоком — бросает в воздухе.
- **Output push-pull** — обычный активный выход. При низком логическом уровне напряжение на выводе равно 0, при высоком — напряжение близко к напряжению питания.


---

### Интерфейсы программирования и отладки

Для того чтобы микроконтроллер или ПЛИС могли выполнять задачи, необходимо записать в память устройства прошивку. Для этого используется **программатор**, который подключается через интерфейсы, такие как COM или USB порты, к выводам микросхемы.

#### 1. **JTAG (Joint Test Action Group)**

##### 1.1. Расшифровка
**JTAG** (Joint Test Action Group) — стандарт для тестирования и отладки цифровых устройств, таких как микроконтроллеры и ПЛИС, через последовательный интерфейс.

##### 1.2. История появления
JTAG был разработан в 1985 году для тестирования соединений на печатных платах и позже стал использоваться для программирования и отладки микроконтроллеров и ПЛИС.

##### 1.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный:** Да, работает с тактовым сигналом.
- **Напряжение:** 3.3 В или 5 В.
- **Скорость передачи:** От нескольких Мбит/с до десятков Мбит/с.

##### 1.4. Необходимые линии интерфейса
- **TCK (Test Clock)** — тактовый сигнал.
- **TDI (Test Data In)** — входные тестовые данные.
- **TDO (Test Data Out)** — выходные тестовые данные.
- **TMS (Test Mode Select)** — выбор режима.
- **TRST (Test Reset)** — сброс JTAG (не всегда используется).

##### 1.5. Принцип работы
JTAG используется для доступа к внутренним регистраторам устройства, тестирования соединений, программирования и отладки.

##### 1.6. Режимы работы
- **Тестирование соединений** (Boundary Scan).
- **Программирование микроконтроллеров и ПЛИС**.
- **Отладка**.

##### 1.7. Область применения
- **Когда использовать:** Для тестирования и отладки сложных систем.
- **Когда не использовать:** Для простых систем, где JTAG избыточен.

##### 1.8. Ссылка на стандарт
- **IEEE 1149.1-2013** — Standard for Test Access Port and Boundary-Scan Architecture.  
  [IEEE 1149.1-2013 на IEEE Xplore](https://ieeexplore.ieee.org/document/6548334)

---

#### 2. **SWD (Serial Wire Debug)**

##### 2.1. Расшифровка
**SWD** (Serial Wire Debug) — это интерфейс для отладки, разработанный архитектурой ARM.

##### 2.2. История появления
SWD был разработан как облегчённая версия интерфейса JTAG для упрощения отладки микроконтроллеров с минимальным количеством линий.

##### 2.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный:** Да, с тактовым сигналом.
- **Напряжение:** 3.3 В.
- **Скорость передачи:** Обычно до 10 Мбит/с.

##### 2.4. Необходимые линии интерфейса
- **SWDIO (Serial Wire Data In/Out)** — двусторонняя линия для передачи данных.
- **SWCLK (Serial Wire Clock)** — тактовый сигнал.

##### 2.5. Принцип работы
SWD использует только две линии, что делает его более компактным по сравнению с JTAG. Он позволяет отлаживать программы и получать доступ к внутренним регистраторам устройства.

##### 2.6. Режимы работы
- **Отладка** — для программной отладки и диагностики.
  
##### 2.7. Область применения
- **Когда использовать:** Когда необходима компактность и экономия проводов (например, в устройствах ARM).
- **Когда не использовать:** Для устройств, не поддерживающих SWD.

---

#### 3. **SWIM (Single Wire Interface Module)**

##### 3.1. Расшифровка
**SWIM** — интерфейс для программирования и отладки, разработанный компанией STMicroelectronics для микроконтроллеров STM8.

##### 3.2. История появления
SWIM был разработан для упрощения интерфейса с 8-битными микроконтроллерами STM8 и использования только одной линии для передачи данных.

##### 3.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный:** Да.
- **Напряжение:** 3.3 В или 5 В.
- **Скорость передачи:** До 1 Мбит/с.

##### 3.4. Необходимые линии интерфейса
- **SWIM** — единственная линия для передачи и получения данных.

##### 3.5. Принцип работы
SWIM использует одну линию для передачи данных, что упрощает подключение к микроконтроллеру STM8.

##### 3.6. Режимы работы
- **Программирование** — запись прошивки в микроконтроллер.
- **Отладка** — мониторинг работы программы.

##### 3.7. Область применения
- **Когда использовать:** Для микроконтроллеров STM8, когда важна минимизация линий.
- **Когда не использовать:** Для других типов микроконтроллеров.

---

### Интерфейсы передачи/обмена пользовательскими данными

#### 4. **UART (Universal Asynchronous Receiver-Transmitter)**

##### 4.1. Расшифровка
**UART** — это последовательный интерфейс для асинхронной передачи данных.

##### 4.2. История появления
UART был создан для обмена данными между устройствами, такими как компьютеры и периферийные устройства, без необходимости в тактовом сигнале.

##### 4.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный/асинхронный:** Асинхронный.
- **Напряжение:** 3.3 В или 5 В.
- **Скорость передачи:** От 9600 до 115200 бит/с и выше.

##### 4.4. Необходимые линии интерфейса
- **TX** — линия передачи данных.
- **RX** — линия приема данных.

##### 4.5. Принцип работы
UART — это асинхронный последовательный интерфейс, который передает данные без использования тактового сигнала. Он использует две линии: TX (передача данных) и RX (прием данных), где данные передаются побитно. В отличие от синхронных интерфейсов, UART работает без общего тактового сигнала, а синхронизация происходит с помощью стартового и стопового битов. Для успешной передачи и приема данных устройства должны работать с одинаковыми параметрами, такими как скорость передачи и количество бит в кадре. UART широко используется для обмена данными между микроконтроллерами и внешними устройствами.

##### 4.6. Режимы работы
- **Полудуплекс** — передача данных поочередно.
- **Полнодуплекс** — одновременная передача и прием.

##### 4.7. Область применения
- **Когда использовать:** Для простых и эффективных коммуникаций между устройствами.
- **Когда не использовать:** Когда необходима высокая скорость передачи данных.

##### 4.8. Ссылка на стандарт
- **RS-232** — Standard for Serial Communication.  
  [RS-232 Standard на Electronics Tutorials](https://www.electronics-tutorials.ws/io/rs-232.html)
---

#### 5. **SPI (Serial Peripheral Interface)**

##### 5.1. Расшифровка
**SPI** — это последовательный периферийный интерфейс для обмена данными между устройствами.

##### 5.2. История появления
SPI был разработан компанией Motorola и широко используется для обмена данными между микроконтроллером и периферийными устройствами.

##### 5.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный:** Да.
- **Напряжение:** 3.3 В или 5 В.
- **Скорость передачи:** Высокая (до десятков Мбит/с).

##### 5.4. Необходимые линии интерфейса
- **MOSI** — линия передачи данных от ведущего устройства.
- **MISO** — линия передачи данных от подчиненного устройства.
- **SCK** — тактовый сигнал.
- **SS** — выбор подчиненного устройства.

##### 5.5. Принцип работы
SPI — это синхронный последовательный интерфейс, который использует четыре основные линии: MOSI (Master Out Slave In), MISO (Master In Slave Out), SCK (тактовый сигнал) и SS (выбор подчиненного устройства). В SPI данные передаются побитно, и синхронизация осуществляется с помощью тактового сигнала, который генерирует ведущий (master) устройства. Каждое подчиненное устройство на шине имеет свою линию выбора (SS), что позволяет обмениваться данными с несколькими периферийными устройствами. SPI является высокоскоростным интерфейсом, который обеспечивает быстрый обмен данными между микроконтроллером и периферийными устройствами. Он работает в полнодуплексном режиме, позволяя одновременно передавать и принимать данные.

##### 5.6. Режимы работы
- **Основной режим** — обмен данными с периферийными устройствами.

##### 5.7. Область применения
- **Когда использовать:** Для быстрого обмена данными с периферийными устройствами.
- **Когда не использовать:** Когда необходимо подключить больше одного устройства без дополнительной логики.

##### 5.8. Ссылка на стандарт
- **SPI (Serial Peripheral Interface)** — Specification by Motorola.  
  [Motorola SPI Specification PDF](https://www.nxp.com/docs/en/data-sheet/SPI.pdf)

---

#### 6. **I2C (Inter-Integrated Circuit)**

##### 6.1. Расшифровка
**I2C** — последовательный интерфейс для связи интегральных схем внутри электронных устройств.

##### 6.2. История появления
I2C был разработан компанией Philips в 1980-х годах как интерфейс для связи микросхем на одной печатной плате.

##### 6.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный:** Да.
- **Напряжение:** 3.3 В или 5 В.
- **Скорость передачи:** 100 кбит/с — 3.4 Мбит/с.

##### 6.4. Необходимые линии интерфейса
- **SDA** — линия передачи данных.
- **SCL** — тактовая линия.

##### 6.5. Принцип работы
В I2C существует один ведущий (master) и несколько подчиненных (slave) устройств, и ведущий инициирует обмен данными, контролируя тактовый сигнал. Каждое устройство на шине имеет уникальный адрес, который используется для идентификации при передаче данных. Данные передаются побитно по линии SDA, а синхронизация осуществляется через тактовую линию SCL, что делает интерфейс синхронным. I2C поддерживает арбитраж, который позволяет нескольким ведущим устройствам конкурировать за право управления шиной, предотвращая конфликты при одновременных запросах.

##### 6.6. Режимы работы
- **Мастера** и **подчиненные** устройства.
- **Арбитраж** — для предотвращения конфликтов между ведущими устройствами.

##### 6.7. Область применения
- **Когда использовать:** Для связи множества устройств на одной шине.
- **Когда не использовать:** Когда требуется высокая скорость передачи данных.

##### 6.8. Ссылка на стандарт
- **I2C (Inter-Integrated Circuit)** — Standard for Data Communication.  
  [I2C Standard на NXP](https://www.nxp.com/docs/en/user-guide/UM10204.pdf)
  
---

#### 7. **CAN (Controller Area Network)**

##### 7.1. Расшифровка
**CAN** — это последовательный интерфейс для связи между интеллектуальными устройствами, датчиками и исполнительными механизмами.

##### 7.2. История появления
CAN был разработан в 1980-х годах для автомобильной электроники и применяется для обмена данными между узлами на высокоскоростных шинах.

##### 7.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный:** Да.
- **Напряжение:** 3.3 В или 5 В.
- **Скорость передачи:** 1 Мбит/с.

##### 7.4. Необходимые линии интерфейса
- **CAN_H** и **CAN_L** — дифференциальные линии передачи.

##### 7.5. Принцип работы
CAN — это дифференциальный последовательный интерфейс, предназначенный для связи между микроконтроллерами и периферийными устройствами в системах с несколькими узлами, например, в автомобилях. Он использует две линии передачи: CAN_H (высокий уровень) и CAN_L (низкий уровень), что обеспечивает высокую помехоустойчивость и надежность связи. CAN использует механизм арбитража, при котором устройства с меньшим идентификатором сообщения получают приоритет в передаче данных. Шина CAN позволяет нескольким устройствам обмениваться данными, но только одно устройство может передавать данные в любой момент времени. Скорость передачи данных в CAN может достигать 1 Мбит/с.

##### 7.6. Режимы работы
- **Арбитраж** — сообщение с наименьшим идентификатором имеет приоритет.

##### 7.7. Область применения
- **Когда использовать:** В системах с несколькими устройствами, где важна высокая помехоустойчивость.
- **Когда не использовать:** Когда простота и низкая стоимость важнее.

##### 7.8. Ссылка на стандарт
- **ISO 11898-1:2015** — Road vehicles — Controller area network (CAN) — Part 1: Data link layer and physical signalling.  
  [ISO 11898-1:2015 на ISO.org](https://www.iso.org/standard/68001.html)

---

#### 8. **USB (Universal Serial Bus)**

##### 8.1. Расшифровка
**USB** — это универсальный последовательный интерфейс, предназначенный для подключения различных периферийных устройств к компьютеру.

##### 8.2. История появления
USB был разработан в 1994 году с целью упростить подключение внешних устройств к компьютерам и заменить устаревшие параллельные и последовательные порты.

##### 8.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный/асинхронный:** Асинхронный.
- **Напряжение:** 5 В (типичное), поддерживает также 3.3 В для некоторых устройств.
- **Скорость передачи:** От 12 Мбит/с (USB 1.1) до 40 Гбит/с (USB 4.0).

##### 8.4. Необходимые линии интерфейса
- **D+** и **D-** — линии передачи данных.
- **Vcc** — питание.
- **GND** — земля.
- **USB Power/Charging Line** — линия для зарядки устройств.

##### 8.5. Принцип работы
USB — это асинхронный последовательный интерфейс, предназначенный для подключения различных периферийных устройств к компьютерам и другим устройствам. Он использует четыре линии: VBUS (питание), D+ и D- (передача данных) и GND (земля). USB позволяет обмениваться данными между устройствами на высокой скорости, а также передавать питание через одну шину. Он поддерживает разные режимы работы, включая работу с устройствами в режиме хоста и устройства. В USB существует несколько версий (USB 1.0, 2.0, 3.0, 4.0), каждая из которых поддерживает различные скорости передачи данных, достигая до 40 Гбит/с в последней версии.

##### 8.6. Режимы работы
- **Host-to-Device** (ведущий к устройству).
- **Device-to-Host** (устройство к ведущему).
- **Peer-to-Peer** (между устройствами).

##### 8.7. Область применения
- **Когда использовать:** Для подключения различных устройств (клавиатур, мышей, принтеров, внешних накопителей и т. д.) к компьютеру.
- **Когда не использовать:** Когда требуется высокая пропускная способность при низкой задержке (например, для специфических серверных приложений).

##### 8.8. Ссылка на стандарт
- **USB 2.0/3.0/4.0** — Universal Serial Bus Specifications.  
  [USB 2.0/3.0 на USB Implementers Forum](https://www.usb.org/documents)

---

#### 9. **PCI (Peripheral Component Interconnect)**

##### 9.1. Расшифровка
**PCI** — это стандарт для подключения периферийных устройств к компьютеру с помощью параллельной шины.

##### 9.2. История появления
PCI был разработан в 1990-х годах компанией Intel как решение для обмена данными между компьютером и периферийными устройствами, такими как сетевые карты, видеокарты, звуковые карты и т.д.

##### 9.3. Характеристика
- **Тип:** Параллельный интерфейс.
- **Синхронный/асинхронный:** Синхронный.
- **Напряжение:** 3.3 В или 5 В (в зависимости от устройства).
- **Скорость передачи:** 33 Мбит/с до 133 Мбит/с (в зависимости от версии).

##### 9.4. Необходимые линии интерфейса
- **Data Lines** — несколько линий для передачи данных.
- **Address Lines** — линии для передачи адресной информации.
- **Control Lines** — линии для управления передачей данных.

##### 9.5. Принцип работы
PCI — это параллельный интерфейс, который используется для подключения периферийных устройств, таких как видеокарты, звуковые карты и другие компоненты, к центральному процессору в компьютере. Он использует несколько линий передачи данных, адреса и управления для обмена информацией между устройствами и процессором. PCI позволяет устройствам обмениваться данными с высокой пропускной способностью и предоставляет многоканальную связь для различных периферийных устройств. Интерфейс PCI работает на тактовом сигнале и поддерживает несколько устройств на одной шине. PCI также поддерживает различные конфигурации и возможность обмена данными между устройствами.

##### 9.6. Режимы работы
- **Master-to-Slave** — главный контроллер управляет передачей данных.
- **Slave-to-Master** — периферийное устройство может инициировать передачу.

##### 9.7. Область применения
- **Когда использовать:** В компьютерных системах для подключения таких устройств, как видеокарты, звуковые карты, сетевые карты и т.д.
- **Когда не использовать:** В современных системах, где используется более быстрые интерфейсы, такие как PCI-Express.

##### 9.8. Ссылка на стандарт
- **PCI 2.3** — Peripheral Component Interconnect (PCI) Specification.  
  [PCI 2.3 на PCI-SIG](https://www.pcisig.com/)

---

#### 10. **PCI-Express (PCIe)**

##### 10.1. Расшифровка
**PCI-Express** (PCIe) — это современный высокоскоростной интерфейс для подключения периферийных устройств в компьютере, использующий сериальную передачу данных.

##### 10.2. История появления
PCIe был представлен в 2003 году как улучшенная версия PCI, обеспечивающая более высокую скорость передачи данных и поддержку более эффективной архитектуры.

##### 10.3. Характеристика
- **Тип:** Последовательный интерфейс.
- **Синхронный:** Да, с использованием тактового сигнала.
- **Напряжение:** 3.3 В.
- **Скорость передачи:** От 2.5 Гбит/с до 64 Гбит/с (в зависимости от версии и количества линий).

##### 10.4. Необходимые линии интерфейса
- **Transmit Lines** — линии передачи данных.
- **Receive Lines** — линии приема данных.
- **Ground Line** — линия заземления.

##### 10.5. Принцип работы
PCI-Express (PCIe) — это последовательный интерфейс нового поколения, предназначенный для подключения высокоскоростных периферийных устройств к компьютеру. В отличие от PCI, PCIe использует серию последовательных линий для передачи данных, что позволяет значительно повысить скорость обмена данными. Каждый канал PCIe работает в полном дуплексе, что позволяет одновременно передавать и принимать данные. PCIe поддерживает различные конфигурации с использованием множества линий, например, x1, x4, x8, x16, что позволяет регулировать скорость передачи в зависимости от количества используемых линий. PCIe используется для подключения графических карт, SSD-накопителей и других высокоскоростных устройств и поддерживает скорости до 64 Гбит/с в последней версии 5.0.

##### 10.6. Режимы работы
- **x1, x4, x8, x16, x32** — количество линий, используемых для передачи данных.
- **Full-duplex** — двусторонняя передача данных на каждой линии.

##### 10.7. Область применения
- **Когда использовать:** Для подключения высокоскоростных устройств, таких как графические карты, SSD, сетевые карты и т.д.
- **Когда не использовать:** Для простых устройств, которым не требуется высокая пропускная способность.

##### 10.8. Ссылка на стандарт
- **PCI Express 4.0/5.0** — PCI Express Base Specification.  
  [PCI Express 5.0 на PCI-SIG](https://www.pcisig.com/)

---





### Интерфейсы программирования и отладки

Для того чтобы МК или ПЛИС могли решать задачи и выполнять определенные функции, файл прошивки нужно записать в память микроконтроллераили ПЛИС или, проще говоря, прошить.
Для прошивки применяется устройство, называемое программатор. В зависимости от типа программатора в большинстве случаев вход подключается к COM или USB порту, а выход к определенным выводам микросхемы МК или ПЛИС.

#### Популярные интерфесы отладки и программирования

1. JTAG (Joint Test Action Group)
JTAG — это стандартный интерфейс для тестирования и программирования цифровых устройств. Он изначально был разработан для тестирования соединений на печатных платах, но широко используется и для программирования микроконтроллеров и ПЛИС, а также для отладки.
Использует несколько линий 
TCK (TCLK) (test clock)- тестовая синхронизация
TDI (test data in) - входные тестовые данные 
TDO (test data out) - выходные тестовые данные 
TMS (test mode select) - выбор тестового режима
TRST (test reset) - сброс JTAG в начальное состояние  (используется не всегда)
 
<p align="center" > <img src="./pic/p8.png"></p>

<p align="center" >Рисунок 4 – ...</p>

2. SWD (Serial Wire Debug)
SWD — это интерфейс для отладки, разработанный как часть архитектуры ARM. Он представляет собой сокращенную версию JTAG и предназначен для упрощения отладочных интерфейсов с меньшим количеством линий связи.
 SWD использует всего две линии — SWDIO (данные) и SWCLK (тактовый сигнал), что делает его более компактным по сравнению с JTAG.
 
<p align="center" > <img src="./pic/p9.png"></p>

<p align="center" >Рисунок 4 – ...</p>

3. SWIM (Single Wire Interface Module)
SWIM — это интерфейс для программирования и отладки, разработанный компанией STMicroelectronics для своих 8-битных микроконтроллеров STM8. Он использует только одну линию для передачи данных, что упрощает его интеграцию в схемы. Предоставляет доступ к памяти и регистраторам микроконтроллера.
 
 <p align="center" > <img src="./pic/p10.png"></p>

<p align="center" >Рисунок 4 – ...</p>

### Интерфейсы передачи/обмена пользовательскими данными

#### UART 
UART (Universal Asynchronous Receiver-Transmitter) — это последовательный интерфейс, который используется для асинхронной передачи данных между устройствами. Это один из самых простых и популярных интерфейсов для передачи данных между устройствами.
 Обычно требует двух линий — TX (Transmitter / передача данных) и RX ( Receiver / прием данных), а также иногда линии для контроля потока, такие как CTS и RTS. В отличие от JTAG и SWD, UART не требует отдельного тактового сигнала, так как данные передаются в асинхронном режиме. Используется также для загрузки прошивок в микроконтроллеры (bootloader), простой отладки и мониторинга данных через последовательный интерфейс.
Для связи двух устройств понадобятся два провода, причем соединять их следует крест-накрест RX первого в TX второго и наоборот (куда один передает, там другой принимает). Связь в UART может быть симплексной (данные передаются только в одном направлении), полудуплексной (каждая сторона  передает данные, но не одновременно) или полнодуплексной (одновременная передача и прием данных).
 
 <p align="center" > <img src="./pic/p11.jpg"></p>

<p align="center" >Рисунок 4 – ...</p>

С помощью UART также можно можно связать микроконтроллер и компьютер, но есть одна проблема: у UART интерфейса логические уровни 0 и +5 вольт, а в компьютере логические уровни в интерфейсе RS-232 могут быть от -25 до -3 вольт и от +3 до +25 вольт. Для этого применяют специальный преобразователь уровней на микросхеме MAX232:
 
 <p align="center" > <img src="./pic/p12.jpg"></p>

<p align="center" >Рисунок 4 – ...</p>

Все сигналы UART передаются специально выбранными уровнями, обеспечивающими высокую помехоустойчивость связи. Отметим, что данные передаются в инверсном коде (логической единице соответствует низкий уровень, логическому нулю — высокий уровень. 

<p align="center" > <img src="./pic/p12.png"></p>

<p align="center" >Рисунок 4 – ...</p>

#### SPI
SPI (Serial Peripheral Interface) - последовательный периферийный интерфейс, предназначен для организации обмена данными между двумя устройствами. С его помощью может осуществляться обмен данными между микроконтроллером или ПЛИС и различными устройствами, такими, как АЦП, FLASH-ПЗУ и др. Кроме того, через интерфейс SPI может осуществляться программирование.
  

<p align="center" > <img src="./pic/p13.png"></p>

<p align="center" >Рисунок 4 – ...</p>

<p align="center" > <img src="./pic/p14.jpg"></p>

<p align="center" >Рисунок 4 – ...</p>

CPOL — исходный уровень сигнала синхронизации (если CPOL=0, то линия синхронизации до начала цикла передачи и после его окончания имеет низкий уровень (т.е. первый фронт нарастающий, а последний — падающий), иначе, если CPOL=1, — высокий (т.е. первый фронт падающий, а последний — нарастающий));
CPHA — фаза синхронизации; от этого параметра зависит, в какой последовательности выполняется установка и выборка данных (если CPHA=0, то по переднему фронту в цикле синхронизации будет выполняться выборка данных, а затем, по заднему фронту, — установка данных; если же CPHA=1, то установка данных будет выполняться по переднему фронту в цикле синхронизации, а выборка — по заднему). Информация по режимам SPI обобщена в таблице.
 
 <p align="center" > <img src="./pic/p15.png"></p>

<p align="center" >Рисунок 4 – ...</p>

#### I2C
I2C (Inter-Integrated Circuit) - последовательный асимметричный интерфейс между интегральными схемами внутри электронных приборов.В положительную сторону отличается от UART более высокой скоростью стабильной передачи данных и более стабильной передачей данных на высокой скорости. Кроме того, благодаря своей архитектуре, позволяет подключать к одной шине, состоящей из двух проводов SDA (данные) и SCL (тактовые импульсы), до 128 устройств одновременно, не используя дополнительного оборудования, если не считать двух подтягивающих резисторов.
 
 <p align="center" > <img src="./pic/p16.png"></p>

<p align="center" >Рисунок 4 – ...</p>

Устройство, подключенное к шине, должно быть либо ведущим, либо подчиненным. Ведущее устройство инициирует передачу данных путем передачи адреса подчиненного устройства и типа передачи: чтение или запись. Если к шине подключено несколько ведущих устройств и некоторая их часть одновременно инициировала передачу, применяется механизм арбитража, который учитывает приоритет этих устройств.
<p align="center" > <img src="./pic/p17.png"></p>

<p align="center" >Рисунок 4 – ...</p>

<p align="center" > <img src="./pic/p18.png"></p>

<p align="center" >Рисунок 4 – ...</p>

<p align="center" > <img src="./pic/p19.pngg"></p>

<p align="center" >Рисунок 4 – ...</p>

<p align="center" > <img src="./pic/p20.png"></p>

<p align="center" >Рисунок 4 – ...</p>
    
Ведущее устройство сигнализирует о начале транзакции генерацией на шине условия START (S). Затем, передается пакет адреса с адресом подчиненного устройства (ADDRESS) и указание желаемого направления передачи данных, т.е. чтение или запись (R/W). По завершении передачи всех пакетов данных (DATA), ведущее устройство генерирует на шине условие STOP (P) и транзакция завершается. После приема каждого байта получатель данных генерирует бит подтверждения (A или ACK) или неподтверждения (/A или NACK).
…………………………………………………………………………………………………………...

#### CAN

CAN (Control Area Network) — последовательная магистраль, обеспечивающая увязку в сеть "интеллектуальных" устройств ввода/вывода, датчиков и исполнительных устройств некоторого механизма или даже предприятия. Характеризуется протоколом, обеспечивающим возможность нахождения на магистрали нескольких ведущих устройств, обеспечивающим передачу данных в реальном масштабе времени и коррекцию ошибок, высокой помехоустойчивостью.
Рассматриваемый нами узел сети CAN состоит из микроконтроллера, CAN контроллера и приемопередатчика. Некоторые микроконтроллеры имеют встроенный контроллер CAN, такой как STM32 или PIC18F, в то время как другим требуется внешний контроллер CAN, такой как MCP2515. приемопередатчик подключается к витой паре, на концах которой размещены согласующие резисторы с сопротивлением 120 Ом.
Для формирования логической единицы в витой паре, или свободной шине, на оба провода подается напряжение, равное половине разности напряжения между 0 или Vcc. Логическому нулю соответствует подача на провода линии дифференциального напряжения

<p align="center" > <img src="./pic/p21.png"></p>

<p align="center" >Рисунок 4 – ...</p>

<p align="center" > <img src="./pic/p22.png"></p>

<p align="center" >Рисунок 4 – ...</p>

Пакет сообщения CAN
Формат сообщения CAN показан на рисунке
 
 <p align="center" > <img src="./pic/p23.png"></p>

<p align="center" >Рисунок 4 – ...</p>

Идентификатор сообщения используется для идентификации данных, отправленных в этом пакете. Каждое отправленное сообщение принимается всеми узлами сети и в данном случае идентификатор позволяет понять конкретному устройству, необходимо ли обрабатывать данное сообщение. Максимальная длина сообщения 8 байт. 
Арбитраж на шине CAN: первым по шине CAN всегда передается сообщение с наименьшим идентификатором.

### Служебные выводы

#### Режимы загрузки

Микроконтроллер может начать свою работу в одном из трех различных режимов загрузки. Эти режимы выбираются с помощью выводов BOOT0 и BOOT1. От выбранного режима загрузки зависит, какую область карты памяти микроконтроллер будет считать началом памяти. МК может исполнять код программы из Flash памяти, внутреннего статического ОЗУ или системной памяти.
Для работы в обычном режиме вывод BOOT0 необходимо соединить с GND. Если же планируется использование других режимов, необходимо предусмотреть джамперы для задания различных состояний на выводах управления загрузкой.
BOOT1	BOOT0	Режим запуска программы
0	0	Внутренняя FLASH
1	0	
0	1	Системная память
1	1	Внутреннее ОЗУ

 
<p align="center" > <img src="./pic/p26.png"></p>

<p align="center" >Рисунок 4 – ...</p>

Управляющие сигналы для выбора режима загрузки

ПЛИС также имеет специальные выводы, которые задают режим загрузки. В зависимости от состояния этих выводов выбирается нужный режим конфигурации. Рассмотрим, как это происходит на примере Xilinx и Intel (Altera) ПЛИС.
Для Xilinx FPGA
1.	Многорежимный переключатель M[2:0]:
Эти три пина определяют режим загрузки FPGA Xilinx:
Типичная настройка этих пинов:
•	M[2:0] = 001: Master SPI (конфигурация из внешней SPI FLASH).
•	M[2:0] = 101: Slave SPI (приём данных по SPI).
•	M[2:0] = 110: JTAG (конфигурация через JTAG).
Для Intel (Altera) FPGA
MSEL (Configuration Mode Select):
Пины MSEL[3:0] на микросхеме Intel FPGA задают режим загрузки:
•	Активный последовательный (Active serial (AS)).
•	Активный параллельный (Active parallel (AP)).
•	Пассивный последовательный (Passive serial (PS)).
•	Быстрый пассивный параллельный (Fast passive parallel (FPP)).
•	JTAG.

#### Сброс

Начальный сброс требуется любому МК. Организуется он через выводы NRST (активный НИЗКИЙ уровень) или RST (активный ВЫСОКИЙ уровень). В большинстве широкораспространённых моделей используется NRST. Схема подключения данного вывода приведена в спецификации к МК. Ниже показан одна из возможных схем сброса.

<p align="center" > <img src="./pic/p27.png"></p>

<p align="center" >Рисунок 4 – ...</p>

После того как схема включена, изначально конденсатор C12 разряжен и напряжение на RST почти равно нулю и в результате микроконтроллер не запускается. Получается, что после запуска схемы происходит постоянный сброс. С течением времени происходит заряд конденсатора через резистор, после того как он зарежется на выводе RST появится логическая единица, МК запустится. Кнопка же разряжает конденсатор и происходит перезапуск микроконтроллера.
 Задержку перед стартом МК можно посчитать по формуле как T=R*C при данных значения получается приблизительно одна секунда. Для чего эта задержка? Для того чтобы МК не запускался перед тем как все устройства на плате не запитаются и  не перейдут в установившийся режим работы.
GPIO (General Purpose Input/Output).
General Purpose Input/Output — интерфейс, который содержит Входы и Выходы общего назначения, к которым можно подключать разнообразные исполнительные устройства, датчики, дисплеи, контроллеры, разные модули и разную периферию.
GPIO называют «порт общего назначения», поскольку каждый его разряд может быть свободно настроен для работы по приему как входных, так и для формирования выходных цифровых сигналов.
Регистр портов (PDR). Устанавливает направление для каждого внешнего вывода GPIO - либо на ввод, либо на вывод, либо на ввод/вывод (рис. 1).
Регистр входных данных порта (PIDR). Показывает состояние входных контактов.
Регистр выходных данных порта (PODR). Чтобы выводить данные через выходные выводы, программно записываются выходные значения в этот регистр.

<p align="center" > <img src="./pic/p28.png"></p>

<p align="center" >Рисунок 4 – ...</p>

### Подключение периферии через GPIO

Светодиод

<p align="center" > <img src="./pic/p29.png"></p>

<p align="center" >Рисунок 4 – ...</p>

Как видно из рисунка, в правильном подключении светодиода присутствует гасящий резистор, который ограничивает ток через сам светодиод и используемый им выход порта, соответствующий GPIO4.
При прямом подключении без резистора, на светодиод поступит напряжение +3.3В, что есть больше нормы для светодиодов (2-3В). Прямое напряжение такой величины станет причиной резкого возрастания тока в цепи. Такая ситуация может повлечь за собой выгорание светодиода и выхода из строя как отдельного буфера GPIO, так и микропроцессора в целом.

#### Кнопка

Основные варианты подключения кнопки:
1. Нормально разомкнутая (НО) кнопка
 Кнопка размыкает цепь в неактивном состоянии и замыкает при нажатии.
•	Схема подключения:
o	Один контакт кнопки подключается к источнику питания.
o	Второй контакт подключается к нагрузке, которая, в свою очередь, соединена с другим полюсом источника питания.
2. Нормально замкнутая (НЗ) кнопка
В неактивном состоянии кнопка замыкает цепь, а при нажатии размыкает её.
•	Применение: Обычно используется для остановки оборудования, активации аварийных сигналов, защитных систем.
•	Схема подключения:
o	Один контакт подключается к источнику питания.
o	Второй контакт к нагрузке, которая замыкает цепь до нажатия кнопки.

#### Движковый переключатель
Имеет два состояния, одно из которых замыкает одну цепь, а другое – размыкает. Применяется для переключения между двумя устройствами или режимами работы.
•  Схема подключения:

<p align="center" > <img src="./pic/p30.gif"></p>

<p align="center" >Рисунок 4 – ...</p>
